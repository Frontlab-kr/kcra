<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>통합시스템</title>

		<!-- Global stylesheets -->
		<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700,900" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/icons/icomoon/styles.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/icons/fontawesome/styles.min.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/bootstrap.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/core.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/components.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/colors.min.css" />
		<!-- /global stylesheets -->

		<!-- Core JS files -->
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/loaders/pace.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/bootstrap.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/loaders/blockui.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/app.js"></script>
		<!-- /core JS files -->

		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/ui/moment/moment.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/ui/moment/moment_locales.min.js"></script>

		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/editors/summernote/summernote.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/forms/styling/uniform.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/editors/summernote/lang/summernote-ko-KR.js"></script>

		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/forms/selects/select2.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/jquery-form/jquery.form.js"></script>

		<!-- datepicker -->
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery_ui/core.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery_ui/interactions.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery_ui/widgets.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery_ui/effects.min.js"></script>
		<!-- /datepicker -->

		<script src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script>

		<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/common_js.js"></script>
		<!-- /theme JS files -->
		<!-- sheetjs  -->
		<script type="text/javascript" src="//cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

		<!-- frontlab -->
		<link rel="stylesheet" type="text/css" href="/assets/css/common.css" />
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/colresizable/1.6.0/colResizable-1.6.js"
			integrity="sha512-0HfjrMq6p8VBkVjp/gy/obELN81BCwmKRd7fongBsAPw49BeKAfXpQn6PWSPa8rm7mvblqyV2P1kVNzvW6qR4Q=="
			crossorigin="anonymous"
			referrerpolicy="no-referrer"
		></script>
		<script>
			$(document).ready(function () {
				$('.kcra-list .table').colResizable({
					liveDrag: true,
					gripInnerHtml: "<div class='grip'></div>",
					draggingClass: 'dragging',
					resizeMode: 'fit',
				});
				$('.kcra-sidebar-list__item a').on('click', function () {
					$(this).parents('.kcra-sidebar-list__item').toggleClass('active');
					return false;
				});
			});
		</script>
	</head>

	<body>
		<div class="kcra">
			<div class="kcra-sidebar">
				<div class="kcra-sidebar-logo">
					<a href=""><img src="/assets/images/logo.png" alt="KCRA 한국휴게음식업중앙회교육원" /></a>
				</div>
				<div class="kcra-sidebar-user">
					<div class="dropdown">
						<button id="dLabel" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							<img src="../assets/images/user.png" alt="" />
							관리자
							<span class="material-symbols-outlined"> expand_more </span>
						</button>
						<ul class="dropdown-menu">
							<li>
								<a href="/logout">로그아웃</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="kcra-sidebar-list">
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> settings </span><strong>설정</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> corporate_fare </span><strong>업소정보관리</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> school </span><strong>교육결과조회</strong></a>
					</div>
					<div class="kcra-sidebar-list__item depth">
						<a href=""><span class="material-symbols-outlined"> stress_management </span><strong>집합교육관리조회</strong></a>
						<ul>
							<li class="active">
								<a href="/admin/offline/manage"><span>신규영업자</span></a>
							</li>
						</ul>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> contract_edit </span><strong>통보서관리</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> data_table </span><strong>이관데이터관리</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> analytics </span><strong>수료현황</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> assignment_ind </span><strong>수료자등록</strong></a>
					</div>
					<div class="kcra-sidebar-list__item active depth">
						<a href=""><span class="material-symbols-outlined"> bar_chart_4_bars </span><strong>통계</strong></a>
						<ul>
							<li class="active">
								<a href="/admin/statistics/company"><span>영업대장별 통계</span></a>
							</li>
							<li>
								<a href="/admin/statistics/edu"><span>교육통계</span></a>
							</li>
							<li>
								<a href="/admin/statistics/period"><span>기간대비통계</span></a>
							</li>
							<li>
								<a href="/admin/statistics/age"><span>연령별통계</span></a>
							</li>
						</ul>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""> <span class="material-symbols-outlined"> settings_cinematic_blur </span><strong>계정관리</strong></a>
					</div>
				</div>
			</div>
			<div class="kcra-contents kcra-list-form">
				<div class="kcra-title">
					<h1>교육 통계</h1>
				</div>
				<div class="kcra-form">
					<div class="kcra-form__box">
						<table>
							<colgroup>
								<col style="width: 10%" />
								<col style="width: 40%" />
								<col style="width: 10%" />
								<col style="width: 40%" />
							</colgroup>
							<tbody>
								<tr>
									<th>통계 구분</th>
									<td colspan="3">
										<div>
											<label class="radio-inline"><input type="radio" name="staticType" value="sido" checked />지역별</label>
											<label class="radio-inline"><input type="radio" name="staticType" value="gungu" />구별</label>
										</div>
									</td>
								</tr>
								<tr id="sidoTr" class="hidden">
									<th>시/도</th>
									<td colspan="3">
										<select class="form-control" id="schSido">
											<option value="">시/도</option>
										</select>
									</td>
								</tr>
								<tr>
									<th>영업자구분</th>
									<td>
										<select name="searchCcTarget" id="searchCcTarget" class="form-control">
											<option value="" selected="selected">선택</option>
											<option value="기존영업자">기존영업자</option>
											<option value="신규영업자">신규영업자</option>
											<option value="자판기영업자">자판기영업자</option>
										</select>
									</td>
									<th>기간검색</th>
									<td>
										<div class="kcra-datepicker" style="width: 500px">
											<select name="searchStartYear" id="searchStartYear" class="form-control mr-10">
												<option value="">년도</option>
											</select>
											<select name="searchStartMonth" id="searchStartMonth" class="form-control">
												<option value="">월</option>
											</select>
											<span>~</span>
											<select name="searchEndYear" id="searchEndYear" class="form-control mr-10">
												<option value="">년도</option>
											</select>
											<select name="searchEndMonth" id="searchEndMonth" class="form-control">
												<option value="">월</option>
											</select>
											<script>
												commonAjaxFunc('/common/code/list', { commonCode: 'CMM_MONTH' }, 'GET', function (data) {
													$('#searchStartMonth, #searchEndMonth').empty();
													$('#searchStartMonth, #searchEndMonth').append("<option value=''>월</option>");
													for (var i = 0; i < data.length; i++) {
														$('#searchStartMonth,#searchEndMonth').append("<option value='" + data[i].codeValue + "'>" + data[i].codeName + '</option>');
													}
												});
												commonAjaxFunc('/common/code/list', { commonCode: 'STATIC_YEAR' }, 'GET', function (data) {
													$('#searchStartYear, #searchEndYear').empty();
													$('#searchStartYear, #searchEndYear').append("<option value=''>년도</option>");
													for (var i = 0; i < data.length; i++) {
														$('#searchStartYear, #searchEndYear').append("<option value='" + data[i].codeValue + "'>" + data[i].codeName + '</option>');
													}
												});
											</script>
										</div>
									</td>
								</tr>
								<tr>
									<th>유형</th>
									<td colspan="3">
										<div>
											<label class="radio-inline"><input type="radio" name="searchCcType" value="" checked />전체</label>
											<label class="radio-inline"><input type="radio" name="searchCcType" value="ONLINE" />온라인</label>
											<label class="radio-inline"><input type="radio" name="searchCcType" value="OFFLINE" />집합교육</label>
										</div>
									</td>
								</tr>
								<tr>
									<th>수료여부</th>
									<td colspan="3">
										<div>
											<label class="radio-inline"><input type="radio" name="searchStudyStatus" value="C" checked />수료</label>
											<label class="radio-inline"><input type="radio" name="searchStudyStatus" value="F" />미수료</label>
											<label class="radio-inline"><input type="radio" name="searchStudyStatus" value="M" />복수수료</label>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="kcra-form__button">
						<button type="button" class="btn" onclick="statistics.init();"><span class="material-symbols-outlined"> search </span>검색</button>
					</div>
				</div>
				<div class="kcra-list">
					<div class="kcra-list-head">
						<div class="kcra-list-head__total">조회건수 : <strong>43</strong>건</div>
						<div class="kcra-list-head__button">
							<button type="button" class="btn btn-sm btn-gray" onclick="statistics.excelDown('xlsx');">
								<span class="material-symbols-outlined"> download </span>다운로드
							</button>
						</div>
					</div>
					<div class="table-responsive">
						<table class="table result-table" id="dataTable">
							<thead>
								<tr>
									<th style="background-color: #ddd">지역</th>
									<th style="background-color: #ddd">합계</th>
									<th style="background-color: #ddd; width: 7%">1월</th>
									<th style="background-color: #ddd; width: 7%">2월</th>
									<th style="background-color: #ddd; width: 7%">3월</th>
									<th style="background-color: #ddd; width: 7%">4월</th>
									<th style="background-color: #ddd; width: 7%">5월</th>
									<th style="background-color: #ddd; width: 7%">6월</th>
									<th style="background-color: #ddd; width: 7%">7월</th>
									<th style="background-color: #ddd; width: 7%">8월</th>
									<th style="background-color: #ddd; width: 7%">9월</th>
									<th style="background-color: #ddd; width: 7%">10월</th>
									<th style="background-color: #ddd; width: 7%">11월</th>
									<th style="background-color: #ddd; width: 7%">12월</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>서울</td>
									<td>22993</td>
									<td>339</td>
									<td>678</td>
									<td>0</td>
									<td>4715</td>
									<td>4388</td>
									<td>1987</td>
									<td>4426</td>
									<td>1983</td>
									<td>1003</td>
									<td>2549</td>
									<td>4215</td>
									<td>7088</td>
								</tr>
								<tr>
									<td>부산</td>
									<td>6190</td>
									<td>119</td>
									<td>219</td>
									<td>0</td>
									<td>122</td>
									<td>657</td>
									<td>751</td>
									<td>1083</td>
									<td>427</td>
									<td>286</td>
									<td>458</td>
									<td>1393</td>
									<td>1636</td>
								</tr>
								<tr>
									<td>인천</td>
									<td>6218</td>
									<td>60</td>
									<td>134</td>
									<td>0</td>
									<td>93</td>
									<td>1104</td>
									<td>829</td>
									<td>1684</td>
									<td>457</td>
									<td>292</td>
									<td>680</td>
									<td>1401</td>
									<td>1926</td>
								</tr>
								<tr>
									<td>대구</td>
									<td>5566</td>
									<td>52</td>
									<td>147</td>
									<td>0</td>
									<td>85</td>
									<td>784</td>
									<td>549</td>
									<td>2196</td>
									<td>210</td>
									<td>336</td>
									<td>706</td>
									<td>1324</td>
									<td>1702</td>
								</tr>
								<tr>
									<td>대전</td>
									<td>3122</td>
									<td>36</td>
									<td>92</td>
									<td>0</td>
									<td>49</td>
									<td>1012</td>
									<td>1147</td>
									<td>692</td>
									<td>207</td>
									<td>90</td>
									<td>333</td>
									<td>595</td>
									<td>636</td>
								</tr>
								<tr>
									<td>광주</td>
									<td>3165</td>
									<td>41</td>
									<td>40</td>
									<td>0</td>
									<td>366</td>
									<td>839</td>
									<td>497</td>
									<td>443</td>
									<td>169</td>
									<td>113</td>
									<td>446</td>
									<td>509</td>
									<td>1146</td>
								</tr>
								<tr>
									<td>울산</td>
									<td>2893</td>
									<td>8</td>
									<td>26</td>
									<td>0</td>
									<td>181</td>
									<td>896</td>
									<td>418</td>
									<td>594</td>
									<td>286</td>
									<td>136</td>
									<td>1082</td>
									<td>379</td>
									<td>430</td>
								</tr>
								<tr>
									<td>세종</td>
									<td>698</td>
									<td>12</td>
									<td>23</td>
									<td>0</td>
									<td>96</td>
									<td>154</td>
									<td>71</td>
									<td>55</td>
									<td>16</td>
									<td>85</td>
									<td>72</td>
									<td>166</td>
									<td>233</td>
								</tr>
								<tr>
									<td>경기</td>
									<td>28540</td>
									<td>362</td>
									<td>506</td>
									<td>0</td>
									<td>662</td>
									<td>2787</td>
									<td>2225</td>
									<td>2227</td>
									<td>975</td>
									<td>851</td>
									<td>3288</td>
									<td>9042</td>
									<td>10438</td>
								</tr>
								<tr>
									<td>강원</td>
									<td>1791</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>560</td>
									<td>654</td>
									<td>346</td>
									<td>227</td>
									<td>4</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>충북</td>
									<td>3899</td>
									<td>44</td>
									<td>82</td>
									<td>0</td>
									<td>86</td>
									<td>516</td>
									<td>777</td>
									<td>655</td>
									<td>270</td>
									<td>154</td>
									<td>412</td>
									<td>895</td>
									<td>1348</td>
								</tr>
								<tr>
									<td>충남</td>
									<td>4482</td>
									<td>50</td>
									<td>89</td>
									<td>0</td>
									<td>259</td>
									<td>1422</td>
									<td>491</td>
									<td>317</td>
									<td>159</td>
									<td>695</td>
									<td>730</td>
									<td>1072</td>
									<td>1331</td>
								</tr>
								<tr>
									<td>전북</td>
									<td>3896</td>
									<td>97</td>
									<td>225</td>
									<td>0</td>
									<td>85</td>
									<td>361</td>
									<td>319</td>
									<td>500</td>
									<td>225</td>
									<td>133</td>
									<td>295</td>
									<td>839</td>
									<td>1468</td>
								</tr>
								<tr>
									<td>전남</td>
									<td>3853</td>
									<td>47</td>
									<td>73</td>
									<td>0</td>
									<td>277</td>
									<td>995</td>
									<td>425</td>
									<td>738</td>
									<td>469</td>
									<td>317</td>
									<td>327</td>
									<td>919</td>
									<td>988</td>
								</tr>
								<tr>
									<td>경북</td>
									<td>5652</td>
									<td>72</td>
									<td>129</td>
									<td>0</td>
									<td>93</td>
									<td>1047</td>
									<td>515</td>
									<td>366</td>
									<td>158</td>
									<td>198</td>
									<td>608</td>
									<td>1658</td>
									<td>2024</td>
								</tr>
								<tr>
									<td>경남</td>
									<td>8876</td>
									<td>162</td>
									<td>505</td>
									<td>0</td>
									<td>129</td>
									<td>668</td>
									<td>398</td>
									<td>414</td>
									<td>180</td>
									<td>283</td>
									<td>1752</td>
									<td>2514</td>
									<td>2898</td>
								</tr>
								<tr>
									<td>제주</td>
									<td>2763</td>
									<td>54</td>
									<td>139</td>
									<td>0</td>
									<td>60</td>
									<td>750</td>
									<td>488</td>
									<td>252</td>
									<td>60</td>
									<td>224</td>
									<td>601</td>
									<td>490</td>
									<td>964</td>
								</tr>
								<tr>
									<td>합계</td>
									<td>150173</td>
									<td>1555</td>
									<td>3107</td>
									<td>0</td>
									<td>7918</td>
									<td>19034</td>
									<td>12233</td>
									<td>16869</td>
									<td>6255</td>
									<td>5196</td>
									<td>14339</td>
									<td>27411</td>
									<td>36256</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="kcra-pagination">
						<ul class="pagination">
							<li><a href="javascript:goPage(1);">이전</a></li>
							<li class="active"><a href="#">1</a></li>
							<li><a href="javascript:goPage('2');">2</a></li>
							<li><a href="javascript:goPage('3');">3</a></li>
							<li><a href="javascript:goPage('4');">4</a></li>
							<li><a href="javascript:goPage('5');">5</a></li>
							<li><a href="javascript:goPage('6');">6</a></li>
							<li><a href="javascript:goPage('7');">7</a></li>
							<li><a href="javascript:goPage('8');">8</a></li>
							<li><a href="javascript:goPage('9');">9</a></li>
							<li><a href="javascript:goPage('10');">10</a></li>
							<li><a href="javascript:goPage(11);">다음</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
<script>
	$('input[name=staticType]').change(function () {
		if ($('input[name=staticType]:checked').val() == 'sido') {
			$('#sidoTr').addClass('hidden');
			$('#schSido').empty();
		} else {
			$('#sidoTr').removeClass('hidden');
			getSido();
		}
	});
	function getSido() {
		commonAjaxFunc('/common/sido', {}, 'GET', function (data) {
			$('#schSido').empty();
			$('#schSido').append("<option value=''>시/도</option>");
			for (var i = 0; i < data.length; i++) {
				$('#schSido').append("<option value='" + data[i].sidoNo + "'>" + data[i].sidoNm + '</option>');
			}
		});
	}
	var statistics = (function () {
		var makeTableHeader = function () {
			commonAjaxFunc('/common/code/list', { commonCode: 'CMM_MONTH' }, 'GET', function (data) {
				var theadHtml = "<tr><th style='background-color:#ddd;'>지역</th><th style='background-color:#ddd;'>합계</th>";
				if (data != null) {
					for (var i = 0; i < data.length; i++) {
						theadHtml += "<th style='background-color:#ddd;width:7%;'>" + data[i].codeName + '</th>';
					}
				}
				theadHtml += '</tr>';
				$('#dataTable thead').html(theadHtml);
			});
			//statistics.init();
		};
		var init = function () {
			var staticType = $('input[name=staticType]:checked').val();
			if (isEmpty($('#searchCcTarget').val())) {
				alert('영업자 구분을 선택해주세요.');
				return false;
			}
			if ($('input[name=staticType]:checked').val() == 'gungu') {
				if (isEmpty($('#schSido').val())) {
					alert('시/도를 선택해주세요.');
					return false;
				}
			}

			var searchStartDate = $('#searchStartYear').val() + $('#searchStartMonth').val();
			var searchEndDate = $('#searchEndYear').val() + $('#searchEndMonth').val();

			commonLoadingAjaxFunc(
				'/statistics/edu/list',
				{
					searchCcTarget: $('#searchCcTarget').val(),
					staticType: $('input[name=staticType]:checked').val(),
					schSido: $('#schSido option:selected').text(),
					searchCcType: $('input[name=searchCcType]:checked').val(),
					searchStartDate: searchStartDate,
					searchEndDate: searchEndDate,
					searchStudyStatus: $('input[name=searchStudyStatus]:checked').val(),
				},
				'GET',
				function (data) {
					var t_result;
					if (staticType == 'gungu') {
						t_result = _(data.list)
							.groupBy('gungu')
							.map((commonCode, id) => ({
								commonCode: id,
								gungu: _.get(_.find(commonCode, 'gungu'), 'gungu'),
								total: _.get(_.find(commonCode, 'total'), 'total'),
								month01: _.sumBy(commonCode, 'month01'),
								month02: _.sumBy(commonCode, 'month02'),
								month03: _.sumBy(commonCode, 'month03'),
								month04: _.sumBy(commonCode, 'month04'),
								month05: _.sumBy(commonCode, 'month05'),
								month06: _.sumBy(commonCode, 'month06'),
								month07: _.sumBy(commonCode, 'month07'),
								month08: _.sumBy(commonCode, 'month08'),
								month09: _.sumBy(commonCode, 'month09'),
								month10: _.sumBy(commonCode, 'month10'),
								month11: _.sumBy(commonCode, 'month11'),
								month12: _.sumBy(commonCode, 'month12'),
							}))
							.value();
					} else {
						t_result = _(data.list)
							.groupBy('commonCode')
							.map((commonCode, id) => ({
								commonCode: id,
								codeName: _.get(_.find(commonCode, 'codeName'), 'codeName'),
								gungu: _.get(_.find(commonCode, 'gungu'), 'gungu'),
								total: _.get(_.find(commonCode, 'total'), 'total'),
								month01: _.sumBy(commonCode, 'month01'),
								month02: _.sumBy(commonCode, 'month02'),
								month03: _.sumBy(commonCode, 'month03'),
								month04: _.sumBy(commonCode, 'month04'),
								month05: _.sumBy(commonCode, 'month05'),
								month06: _.sumBy(commonCode, 'month06'),
								month07: _.sumBy(commonCode, 'month07'),
								month08: _.sumBy(commonCode, 'month08'),
								month09: _.sumBy(commonCode, 'month09'),
								month10: _.sumBy(commonCode, 'month10'),
								month11: _.sumBy(commonCode, 'month11'),
								month12: _.sumBy(commonCode, 'month12'),
							}))
							.value();
					}

					if (data != null) {
						var list = data.list;
						var htmlStr = '';

						if (list == null || list.length == 0) {
							htmlStr += '<tr>';
							htmlStr += '<td colspan="14">데이터가 없습니다.</td>';
							htmlStr += '</tr>';
						} else {
							for (var i = 0; i < t_result.length; i++) {
								var vo = t_result[i];
								htmlStr += '<tr>';
								if (staticType == 'sido') {
									htmlStr += '<td>' + vo.codeName + '</td>';
								} else {
									htmlStr += '<td>' + vo.gungu + '</td>';
								}
								if (isEmpty(vo.total)) {
									htmlStr += '<td>0</td>';
								} else {
									htmlStr += '<td>' + vo.total + '</td>';
								}
								htmlStr += '<td>' + vo.month01 + '</td>';
								htmlStr += '<td>' + vo.month02 + '</td>';
								htmlStr += '<td>' + vo.month03 + '</td>';
								htmlStr += '<td>' + vo.month04 + '</td>';
								htmlStr += '<td>' + vo.month05 + '</td>';
								htmlStr += '<td>' + vo.month06 + '</td>';
								htmlStr += '<td>' + vo.month07 + '</td>';
								htmlStr += '<td>' + vo.month08 + '</td>';
								htmlStr += '<td>' + vo.month09 + '</td>';
								htmlStr += '<td>' + vo.month10 + '</td>';
								htmlStr += '<td>' + vo.month11 + '</td>';
								htmlStr += '<td>' + vo.month12 + '</td>';
								htmlStr += '</tr>';
							}
							htmlStr += '<tr><td>합계</td><td>' + _.sumBy(data.list, 'total') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month01') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month02') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month03') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month04') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month05') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month06') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month07') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month08') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month09') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month10') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month11') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month12') + '</td>';
							htmlStr += '</tr>';
						}
						$('#dataTable tbody').html(htmlStr);
					}
				}
			);
		};
		var excelDown = function (type, fn) {
			var elt = document.getElementById('dataTable');
			var wb = XLSX.utils.table_to_book(elt, { sheet: '통계', raw: true });
			var date = moment().format('YYYYMMDD');
			XLSX.writeFile(wb, fn || 'edu_statistics_' + date + '.' + (type || 'xlsx'));
		};
		return { makeTableHeader: makeTableHeader, init: init, excelDown: excelDown };
	})();
	statistics.makeTableHeader();
</script>
