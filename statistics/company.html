<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>통합시스템</title>

		<!-- Global stylesheets -->
		<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700,900" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/icons/icomoon/styles.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/icons/fontawesome/styles.min.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/bootstrap.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/core.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/components.css" />
		<link rel="stylesheet" type="text/css" href="http://dev2.onesnc.co.kr/static/global_assets/css/colors.min.css" />
		<!-- /global stylesheets -->

		<!-- Core JS files -->
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/loaders/pace.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/bootstrap.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/loaders/blockui.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/app.js"></script>
		<!-- /core JS files -->

		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/ui/moment/moment.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/ui/moment/moment_locales.min.js"></script>

		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/editors/summernote/summernote.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/forms/styling/uniform.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/editors/summernote/lang/summernote-ko-KR.js"></script>

		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/forms/selects/select2.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/plugins/jquery-form/jquery.form.js"></script>

		<!-- datepicker -->
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery_ui/core.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery_ui/interactions.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery_ui/widgets.min.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/global_assets/js/core/libraries/jquery_ui/effects.min.js"></script>
		<!-- /datepicker -->

		<script src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script>

		<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
		<script src="http://dev2.onesnc.co.kr/static/common_js.js"></script>
		<!-- /theme JS files -->
		<!-- sheetjs  -->
		<script type="text/javascript" src="//cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

		<!-- frontlab -->
		<link rel="stylesheet" type="text/css" href="/assets/css/common.css" />
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/colresizable/1.6.0/colResizable-1.6.js"
			integrity="sha512-0HfjrMq6p8VBkVjp/gy/obELN81BCwmKRd7fongBsAPw49BeKAfXpQn6PWSPa8rm7mvblqyV2P1kVNzvW6qR4Q=="
			crossorigin="anonymous"
			referrerpolicy="no-referrer"
		></script>
		<script>
			$(document).ready(function () {
				$('.kcra-list .table').colResizable({
					liveDrag: true,
					gripInnerHtml: "<div class='grip'></div>",
					draggingClass: 'dragging',
					resizeMode: 'fit',
				});
				$('.kcra-sidebar-list__item a').on('click', function () {
					$(this).parents('.kcra-sidebar-list__item').toggleClass('active');
					return false;
				});
			});
		</script>
	</head>

	<body>
		<div class="kcra">
			<div class="kcra-sidebar">
				<div class="kcra-sidebar-logo">
					<a href=""><img src="/assets/images/logo.png" alt="KCRA 한국휴게음식업중앙회교육원" /></a>
				</div>
				<div class="kcra-sidebar-user">
					<div class="dropdown">
						<button id="dLabel" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							<img src="../assets/images/user.png" alt="" />
							관리자
							<span class="material-symbols-outlined"> expand_more </span>
						</button>
						<ul class="dropdown-menu">
							<li>
								<a href="/logout">로그아웃</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="kcra-sidebar-list">
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> settings </span><strong>설정</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> corporate_fare </span><strong>업소정보관리</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> school </span><strong>교육결과조회</strong></a>
					</div>
					<div class="kcra-sidebar-list__item depth">
						<a href=""><span class="material-symbols-outlined"> stress_management </span><strong>집합교육관리조회</strong></a>
						<ul>
							<li class="active">
								<a href="/admin/offline/manage"><span>신규영업자</span></a>
							</li>
						</ul>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> contract_edit </span><strong>통보서관리</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> data_table </span><strong>이관데이터관리</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> analytics </span><strong>수료현황</strong></a>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""><span class="material-symbols-outlined"> assignment_ind </span><strong>수료자등록</strong></a>
					</div>
					<div class="kcra-sidebar-list__item active depth">
						<a href=""><span class="material-symbols-outlined"> bar_chart_4_bars </span><strong>통계</strong></a>
						<ul>
							<li class="active">
								<a href="/admin/statistics/company"><span>영업대장별 통계</span></a>
							</li>
							<li>
								<a href="/admin/statistics/edu"><span>교육통계</span></a>
							</li>
							<li>
								<a href="/admin/statistics/period"><span>기간대비통계</span></a>
							</li>
							<li>
								<a href="/admin/statistics/age"><span>연령별통계</span></a>
							</li>
						</ul>
					</div>
					<div class="kcra-sidebar-list__item">
						<a href=""> <span class="material-symbols-outlined"> settings_cinematic_blur </span><strong>계정관리</strong></a>
					</div>
				</div>
			</div>
			<div class="kcra-contents kcra-list-form">
				<div class="kcra-title">
					<h1>영업신고별 통계</h1>
				</div>
				<div class="kcra-form">
					<div class="kcra-form__box">
						<form name="searchForm" id="searchForm" method="post">
							<input type="hidden" class="form-control" name="searchStartDate" placeholder="" />
							<input type="hidden" class="form-control" name="searchEndDate" placeholder="" />
							<table>
								<colgroup>
									<col style="width: 10%" />
									<col style="width: 90%" />
								</colgroup>
								<tbody>
									<tr>
										<th>구분</th>
										<td>
											<select name="searchCompanyType" id="searchCompanyType" class="form-control">
												<option value="" selected="selected">구분</option>
												<option value="신규영업자">신규영업자</option>
												<option value="자판기영업자">자판기영업자</option>
											</select>
										</td>
									</tr>
									<tr>
										<th>인허가일자</th>
										<td>
											<div class="kcra-datepicker" style="width: 500px">
												<select name="searchStartYear" id="searchStartYear" class="form-control mr-10">
													<option value="">년도</option>
												</select>
												<select name="searchStartMonth" id="searchStartMonth" class="form-control">
													<option value="">월</option>
												</select>
												<span>~</span>
												<select name="searchEndYear" id="searchEndYear" class="form-control mr-10">
													<option value="">년도</option>
												</select>
												<select name="searchEndMonth" id="searchEndMonth" class="form-control">
													<option value="">월</option>
												</select>
												<script>
													commonAjaxFunc('/common/code/list', { commonCode: 'CMM_MONTH' }, 'GET', function (data) {
														$('#searchStartMonth, #searchEndMonth').empty();
														$('#searchStartMonth, #searchEndMonth').append("<option value=''>월</option>");
														for (var i = 0; i < data.length; i++) {
															$('#searchStartMonth,#searchEndMonth').append("<option value='" + data[i].codeValue + "'>" + data[i].codeName + '</option>');
														}
													});
													commonAjaxFunc('/common/code/list', { commonCode: 'STATIC_YEAR' }, 'GET', function (data) {
														$('#searchStartYear, #searchEndYear').empty();
														$('#searchStartYear, #searchEndYear').append("<option value=''>년도</option>");
														for (var i = 0; i < data.length; i++) {
															$('#searchStartYear, #searchEndYear').append("<option value='" + data[i].codeValue + "'>" + data[i].codeName + '</option>');
														}
													});
												</script>
											</div>
										</td>
									</tr>
									<tr>
										<th>영업상태</th>
										<td>
											<div>
												<label class="radio-inline"><input type="radio" name="searchCompanyStatus" value="" checked />전체</label>
												<label class="radio-inline"><input type="radio" name="searchCompanyStatus" value="1" />운영</label>
												<label class="radio-inline"><input type="radio" name="searchCompanyStatus" value="2" />양도양수</label>
												<label class="radio-inline"><input type="radio" name="searchCompanyStatus" value="3" />상속</label>
												<label class="radio-inline"><input type="radio" name="searchCompanyStatus" value="4" />폐업</label>
												<label class="radio-inline"><input type="radio" name="searchCompanyStatus" value="5" />기타</label>
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</form>
					</div>
					<div class="kcra-form__button">
						<button type="button" class="btn" onclick="statistics.init();"><span class="material-symbols-outlined"> search </span>검색</button>
					</div>
				</div>
				<div class="kcra-list">
					<div class="kcra-list-head">
						<div class="kcra-list-head__total">조회건수 : <strong>43</strong>건</div>
						<div class="kcra-list-head__button">
							<button type="button" class="btn btn-sm btn-gray" onclick="statistics.excelDown('xlsx');">
								<span class="material-symbols-outlined"> download </span>다운로드
							</button>
						</div>
					</div>
					<div class="table-responsive">
						<table class="table result-table" id="dataTable">
							<thead>
								<tr>
									<th style="background-color: #ddd">지역</th>
									<th style="background-color: #ddd">합계</th>
									<th style="background-color: #ddd; width: 7%">1월</th>
									<th style="background-color: #ddd; width: 7%">2월</th>
									<th style="background-color: #ddd; width: 7%">3월</th>
									<th style="background-color: #ddd; width: 7%">4월</th>
									<th style="background-color: #ddd; width: 7%">5월</th>
									<th style="background-color: #ddd; width: 7%">6월</th>
									<th style="background-color: #ddd; width: 7%">7월</th>
									<th style="background-color: #ddd; width: 7%">8월</th>
									<th style="background-color: #ddd; width: 7%">9월</th>
									<th style="background-color: #ddd; width: 7%">10월</th>
									<th style="background-color: #ddd; width: 7%">11월</th>
									<th style="background-color: #ddd; width: 7%">12월</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>서울</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>부산</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>인천</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>대구</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>대전</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>광주</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>울산</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>세종</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>경기</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>강원</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>충북</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>충남</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>전북</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>전남</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>경북</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>경남</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>제주</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
								<tr>
									<td>합계</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
									<td>0</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="kcra-pagination">
						<ul class="pagination">
							<li><a href="javascript:goPage(1);">이전</a></li>
							<li class="active"><a href="#">1</a></li>
							<li><a href="javascript:goPage('2');">2</a></li>
							<li><a href="javascript:goPage('3');">3</a></li>
							<li><a href="javascript:goPage('4');">4</a></li>
							<li><a href="javascript:goPage('5');">5</a></li>
							<li><a href="javascript:goPage('6');">6</a></li>
							<li><a href="javascript:goPage('7');">7</a></li>
							<li><a href="javascript:goPage('8');">8</a></li>
							<li><a href="javascript:goPage('9');">9</a></li>
							<li><a href="javascript:goPage('10');">10</a></li>
							<li><a href="javascript:goPage(11);">다음</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
<script>
	var statistics = (function () {
		var makeTableHeader = function () {
			commonAjaxFunc('/common/code/list', { commonCode: 'CMM_MONTH' }, 'GET', function (data) {
				var theadHtml = "<tr><th style='background-color:#ddd;'>지역</th><th style='background-color:#ddd;'>합계</th>";
				if (data != null) {
					for (var i = 0; i < data.length; i++) {
						theadHtml += "<th style='background-color:#ddd;width:7%;'>" + data[i].codeName + '</th>';
					}
				}
				theadHtml += '</tr>';
				$('#dataTable thead').html(theadHtml);
			});
			statistics.init();
		};
		var init = function () {
			var searchStartDate = $('#searchStartYear').val() + $('#searchStartMonth').val();
			var searchEndDate = $('#searchEndYear').val() + $('#searchEndMonth').val();
			commonAjaxFunc(
				'/statistics/cil/list',
				{
					searchCompanyType: $('#searchCompanyType').val(),
					searchStartDate: searchStartDate,
					searchEndDate: searchEndDate,
					searchCompanyStatus: $('input[name=searchCompanyStatus]:checked').val(),
				},
				'GET',
				function (data) {
					if (data != null) {
						var list = data.list;
						var htmlStr = '';

						if (list == null || list.length == 0) {
						} else {
							for (var i = 0; i < list.length; i++) {
								htmlStr += '<tr>';
								htmlStr += '<td>' + list[i].codeName + '</td>';
								htmlStr += '<td>' + list[i].total + '</td>';
								htmlStr += '<td>' + list[i].month01 + '</td>';
								htmlStr += '<td>' + list[i].month02 + '</td>';
								htmlStr += '<td>' + list[i].month03 + '</td>';
								htmlStr += '<td>' + list[i].month04 + '</td>';
								htmlStr += '<td>' + list[i].month05 + '</td>';
								htmlStr += '<td>' + list[i].month06 + '</td>';
								htmlStr += '<td>' + list[i].month07 + '</td>';
								htmlStr += '<td>' + list[i].month08 + '</td>';
								htmlStr += '<td>' + list[i].month09 + '</td>';
								htmlStr += '<td>' + list[i].month10 + '</td>';
								htmlStr += '<td>' + list[i].month11 + '</td>';
								htmlStr += '<td>' + list[i].month12 + '</td>';
								htmlStr += '</tr>';
							}
							htmlStr += '<tr><td>합계</td><td>' + _.sumBy(data.list, 'total') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month01') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month02') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month03') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month04') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month05') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month06') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month07') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month08') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month09') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month10') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month11') + '</td>';
							htmlStr += '<td>' + _.sumBy(data.list, 'month12') + '</td>';
							htmlStr += '</tr>';
						}
						$('#dataTable tbody').html(htmlStr);
					}
				}
			);
		};

		/* var excelDown = function(){
			var searchStartDate = $("#searchStartYear").val()+$("#searchStartMonth").val();
			var searchEndDate = $("#searchEndYear").val()+$("#searchEndMonth").val();
			$("input[name=searchStartDate]").val(searchStartDate);
			$("input[name=searchEndDate]").val(searchEndDate);
			if (confirm("엑셀을 다운로드 하시겠습니까?")) {
				$("form[name=searchForm]").attr("action", "/statistics/cil/excel");
				$("form[name=searchForm]").submit();
			}
		} */
		var excelDown = function (type, fn) {
			var elt = document.getElementById('dataTable');
			var wb = XLSX.utils.table_to_book(elt, { sheet: '통계', raw: true });
			var date = moment().format('YYYYMMDD');
			XLSX.writeFile(wb, fn || 'edu_statistics_' + date + '.' + (type || 'xlsx'));
		};
		return { makeTableHeader: makeTableHeader, init: init, excelDown: excelDown };
	})();
	statistics.makeTableHeader();
</script>
